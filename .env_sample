# --- Log & Path Configuration ---
# Your http Nginx log path
LOG_PATH="samples/nginx_access.log"
WHITE_LIST_PATH="./whitelist.txt"
BANNED_FILE_PATH="./banned_ips.txt"

# --- Rules Configuration (v0.2.0+) ---
# Path to rules.conf file for weighted scoring (leave empty for backward-compatible mode)
RULES_PATH="./rules.conf"
# Multiplier for repeat path hits (0.1 = 10% of original score)
REPEAT_PENALTY=0.1

# --- Heuristics ---
# Score threshold before a ban (10.0 is standard, lower for stricter)
# When using rules: paths are scored, and ban triggers when cumulative score >= threshold
# Without rules: each 4xx = 1.0 score (backward compatible with count-based threshold)
BAN_THRESHOLD=10
# How long to remember errors before they expire from memory
BAN_WINDOW="15m"

# --- Burst Detection (v0.4.0+) ---
# Instant ban when an IP sends N 4xx requests within a short window (catches aggressive scanners)
# Set BURST_LIMIT=0 to disable burst detection entirely
BURST_LIMIT=5
# Sliding window duration for burst counting
BURST_WINDOW="3s"
# Poll interval for tail -f style log monitoring (lower = faster reaction, slightly more CPU)
TAIL_POLL_INTERVAL="100ms"

# --- Firewall Settings ---
# The name of the nftables set we created in the 'inet filter' table
NFT_SET_NAME="parasites"
NFT_SET_NAME_V6="parasites6"

# --- Operational Modes ---
# Set to 'true' to see what would happen without actually banning anyone
PREVIEW_MODE=true

# --- Regex Configuration ---
# If you need to override the default Nginx/Apache regex, do it here.
# Leave empty to use the built-in dual-fallback logic.
REGEX_OVERRIDE=""

SCAN_ALL_MODE=false